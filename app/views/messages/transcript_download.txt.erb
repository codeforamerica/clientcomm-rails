Viewing messages between client <%= "#{@client.first_name} #{@client.last_name}" %> and <%= current_user.full_name %>
Retrieved at: <%= Time.now %>
--------------------------
<% @messages.each_with_index do |message, i| %>
  <% message_status = message.twilio_status.blank? ? 'failed' : message.twilio_status %>
  <% message_error = ['undelivered', 'failed', nil].include?(message_status) %>

  <% unless message.transfer_marker? %>
    <%= i %>. <%= 'UNDELIVERED: ' if message_error %><%= message.inbound ? "#{@client.first_name} #{@client.last_name}" : current_user.full_name %>: <%= message.body %>
-- <%= message.inbound ? "#{t(message_status, scope: 'message.transcript.status')} from cell (#{message.number_from})" : "#{t(message_status, scope: 'message.transcript.status')} to cell (#{message.number_to})" %>
-- on <%= message.send_at.strftime("%b %-d %Y, %-l:%M:%S %P") %>
    <% if message_error %>
-- ERROR: <%= t('message.status.undelivered') %>
    <% end %>
  <% else %>
-- <%= message.body %> --
<%= message.send_at.strftime("%b %-d %Y, %-l:%M:%S %P") %>
  <% end %>
<% end %>
